<!-- Top Panel -->
<div class="top-panel">
    <h3>Generate Personnel Report</h3>
</div>

<div class="container toolbar">
    <div class="row align-items-center">
      <div class="col d-flex justify-content-start">
        <button type="button" class="btn btn-return" routerLink="/reporting">
          <i class="fa-solid fa-arrow-left"></i> Return
        </button>
      </div>
  </div>
</div>

<div class="search-bar-wrapper">
  <div class="input-group custom-search-bar">
    <input type="text" class="text-input input form-control flex-fill" placeholder="Search User..." name="searchString" autocomplete="off" [(ngModel)]="searchTerm" (ngModelChange)="OnSearch()">
    <span class="input-group-text" *ngIf="searchTerm" (click)="ClearSearchTerm()">
      <i class="fa-solid fa-times"></i>
    </span>
    <span class="input-group-text" *ngIf="!searchTerm">
      <i class="fa-solid fa-filter"></i>
    </span>
  </div>
  
  <div class="input-group custom-search-bar">
    <input type="text" class="text-input input form-control flex-fill" placeholder="Search Supplier..." name="searchStringSupplier" autocomplete="off" [(ngModel)]="searchTermSupplier" (ngModelChange)="OnSearchSupplier()">
    <span class="input-group-text" *ngIf="searchTermSupplier" (click)="ClearSearchTermSupplier()">
      <i class="fa-solid fa-times"></i>
    </span>
    <span class="input-group-text" *ngIf="!searchTermSupplier">
      <i class="fa-solid fa-filter"></i>
    </span>
  </div>
  
  <div class="input-group custom-search-bar">
    <input type="text" class="text-input input form-control flex-fill" placeholder="Search Contractor..." name="searchStringContractor" autocomplete="off" [(ngModel)]="searchTermContractor" (ngModelChange)="OnSearchContractor()">
    <span class="input-group-text" *ngIf="searchTermContractor" (click)="ClearSearchTermContractor()">
      <i class="fa-solid fa-times"></i>
    </span>
    <span class="input-group-text" *ngIf="!searchTermContractor">
      <i class="fa-solid fa-filter"></i>
    </span>
  </div>
</div>








<div class="table-wrapper">
    <!-- User Table -->
<div class="table-container">
    <table class="table table-hover">
      <thead>
        <tr>
            <th><u>User ID</u></th>
          <th><u>Username</u></th>
        </tr>
      </thead>
      <tbody *ngFor="let user of users">
        <tr>
          <td>{{ user.user_ID }}</td>
          <td>{{ user.username }}</td>
        </tr>
      </tbody>
      <tfoot style="position:sticky; bottom:0%">
        <tr>
          <td><b>Total Users</b></td>
          <td><b>{{users.length}}</b></td>
        </tr>
      </tfoot>
      <tbody *ngIf="users.length === 0">
        <tr>
          <td colspan="9">No User Listings</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Table List -->
<div class="table-container">
    <table class="table table-hover">
      <thead>
        <tr>
          <th><u>Supplier ID</u></th>
          <th><u>Supplier Name</u></th>
        </tr>
      </thead>
      <tbody *ngFor="let supplier of suppliers">
        <tr>
          <td>{{ supplier.supplier_ID }}</td>
          <td>{{ supplier.supplier_Name }}</td>
        </tr>
      </tbody>
      <tfoot style="position:sticky; bottom:0%">
        <tr>
          <td><b>Total Suppliers</b></td>
          <td><b>{{suppliers.length}}</b></td>
        </tr>
      </tfoot>
      <tbody *ngIf="suppliers.length === 0">
        <tr>
          <td colspan="6">No Supplier Listings</td>
        </tr>
      </tbody>
    </table>
  </div>

    <!-- User Table -->
<!-- Table List -->
<div class="table-container">
    <table class="table table-hover">
      <thead>
        <tr>
            <th><u>Contractor ID</u></th>
          <th><u>Contractor Name</u></th>
        </tr>
      </thead>
      <tbody *ngFor="let contractor of contractors">
        <tr>
            <td>{{ contractor.contractor_ID }}</td>
          <td>{{ contractor.contractor_Name }}</td>
        </tr>
      </tbody>
      <tfoot style="position:sticky; bottom:0%">
        <tr>
          <td><b>Total Contractors</b></td>
          <td><b>{{contractors.length}}</b></td>
        </tr>
      </tfoot>
      <tbody *ngIf="contractors.length === 0">
        <tr>
          <td colspan="6">No Contractor Listings</td>
        </tr>
      </tbody>
    </table>
    </div>

</div>


<div class="button-container">
  <button class="Generate-button" (click)="generatePDF(); OpenPDFModal(PDFModal)" >Generate PDF</button> 
</div>

<div class="generate-container">
  <h4>Total Internal Personnel: {{ calculateTotalQuantityUsers() }}</h4>
  <h4>Total External Personnel: {{ calculateTotalQuantityExternal() }}</h4>
</div>
<div class="generate-container">
  <h4>Total Personnel: {{ calculateTotalQuantityPersonnel() }}</h4>
</div>


<!-- PDF modal template -->
<ng-template #PDFModal let-modal class="modal fade">
  <div class="modal-header">
    <h5 class="modal-title">Generated Stock Report</h5>
  </div>
  <div class="modal-body">
    <!-- Embed the PDF using an iframe -->
    <iframe [src]="pdfSrc" width="100%" height="500px"></iframe>
    <div class="modal-button-container">
      <button class="btn-return" (click)="modal.close('Close click')">Return</button>
      <!-- Add a download button if needed -->
      <button class="btn-add" (click)="downloadPDF()">Download PDF</button>
    </div>
  </div>
  <div class="modal-footer"></div>
</ng-template>


